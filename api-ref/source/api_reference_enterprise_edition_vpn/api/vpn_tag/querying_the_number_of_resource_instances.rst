:original_name: vpn_api_0062.html

.. _vpn_api_0062:

Querying the Number of Resource Instances
=========================================

Function
--------

This API is used to query the number of resource instances based on tags.

Calling Method
--------------

For details, see :ref:`Calling APIs <en-us_topic_0000001807530276>`.

URI
---

POST /v5/{project_id}/{resource_type}/resource-instances/count

.. table:: **Table 1** Parameter description

   +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Type            | Mandatory       | Description                                                                                                                           |
   +=================+=================+=================+=======================================================================================================================================+
   | project_id      | String          | Yes             | Specifies a project ID. You can obtain the project ID by referring to :ref:`Obtaining the Project ID <en-us_topic_0000001807530332>`. |
   +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------+
   | resource_type   | String          | Yes             | -  Specifies the resource type.                                                                                                       |
   |                 |                 |                 |                                                                                                                                       |
   |                 |                 |                 | -  Value range:                                                                                                                       |
   |                 |                 |                 |                                                                                                                                       |
   |                 |                 |                 |    **vpn-gateway**: S2C VPN gateway                                                                                                   |
   |                 |                 |                 |                                                                                                                                       |
   |                 |                 |                 |    **customer-gateway**: customer gateway                                                                                             |
   |                 |                 |                 |                                                                                                                                       |
   |                 |                 |                 |    **vpn-connection**: VPN connection                                                                                                 |
   +-----------------+-----------------+-----------------+---------------------------------------------------------------------------------------------------------------------------------------+

Request
-------

-  Request parameters

   .. table:: **Table 2** Request parameters

      +-----------------+---------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter       | Type                                                                                                          | Mandatory       | Description                                                                                                                                                                                                                                                            |
      +=================+===============================================================================================================+=================+========================================================================================================================================================================================================================================================================+
      | without_any_tag | Boolean                                                                                                       | No              | -  When this parameter is set to **true**, all resources without tags are queried. In this case, the **tags** field is ignored. If this parameter is set to **false** or is not specified, all resources are queried or resources are filtered by "tags" or "matches". |
      +-----------------+---------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | tags            | Array of :ref:`Tag <en-us_topic_0000001807530312__en-us_topic_0000001759791750_table92196>` objects           | No              | -  Specifies a tag list.                                                                                                                                                                                                                                               |
      |                 |                                                                                                               |                 | -  A maximum of 20 tags can be specified.                                                                                                                                                                                                                              |
      +-----------------+---------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
      | matches         | Array of :ref:`Match <en-us_topic_0000001807530312__en-us_topic_0000001759791750_table1255222583313>` objects | No              | -  Specifies a search field, including a key and a value. The match key is the field to be matched, for example, **resource_name**. The match value is the value to be matched. The key is a fixed dictionary value.                                                   |
      +-----------------+---------------------------------------------------------------------------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

   .. _en-us_topic_0000001807530312__en-us_topic_0000001759791750_table92196:

   .. table:: **Table 3** Tag

      +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
      | Parameter       | Type            | Mandatory       | Description                                                                                                                              |
      +=================+=================+=================+==========================================================================================================================================+
      | key             | String          | Yes             | -  Specifies a tag key.                                                                                                                  |
      |                 |                 |                 | -  The value is a string of 1 to 128 characters.                                                                                         |
      +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+
      | values          | Array of String | Yes             | -  Specifies the value list of a tag. If **values** is an empty list, it indicates **any_value**. The relationship between values is OR. |
      |                 |                 |                 | -  The value is a sting of 0 to 255 characters.                                                                                          |
      |                 |                 |                 | -  A maximum of 20 values can be specified.                                                                                              |
      +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------------------------------------------------------------+

   .. _en-us_topic_0000001807530312__en-us_topic_0000001759791750_table1255222583313:

   .. table:: **Table 4** Match

      +-----------------+-----------------+-----------------+-------------------------------------------------+
      | Parameter       | Type            | Mandatory       | Description                                     |
      +=================+=================+=================+=================================================+
      | key             | String          | Yes             | -  Specifies a match key.                       |
      |                 |                 |                 | -  The value is **resource_name**.              |
      +-----------------+-----------------+-----------------+-------------------------------------------------+
      | value           | String          | Yes             | -  Specifies a match value.                     |
      |                 |                 |                 | -  The value is a sting of 0 to 255 characters. |
      +-----------------+-----------------+-----------------+-------------------------------------------------+

-  Example request

   .. code-block:: text

      POST https://{Endpoint}/v5/{project_id}/{resource_type}/resource-instances/count
      {
          "tags": [{
                  "key": "key1",
                  "values": [
                      "value1",
                      "value2"
                  ]
              },
              {
                  "key": "key2",
                  "values": [
                      "value1",
                      "value2"
                  ]
              }
          ],
          "matches": [{
              "key": "resource_name",
              "value": "resource1"
          }],
          "without_any_tag": "false"
      }

Response
--------

-  Response parameters

   Returned status code 200: successful query

   .. table:: **Table 5** Parameters in the response body

      =========== ======= ======================================
      Parameter   Type    Description
      =========== ======= ======================================
      total_count Integer Indicates the total number of records.
      =========== ======= ======================================

-  Example response

   .. code-block::

      {
          "total_count": 1000
      }

Status Codes
------------

For details, see :ref:`Status Codes <en-us_topic_0000001807370508>`.
